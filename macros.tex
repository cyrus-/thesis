% !TEX root = omar-thesis.tex
\newcommand{\dolla}{\texttt{\$}}  % used so I don't screw up syntax highlighting when using $ in an identifier inline

% \newcommand{\gheading}[1]{\multicolumn{3}{l}{\textbf{#1}}}

\newcommand{\elided}{{\color{gray}\cdots}}

% Calculi Names
\newcommand{\miniVerseUE}{\mathsf{miniVerse}_\textbf{UE}}
\newcommand{\miniVersePat}{\mathsf{miniVerse}_\textbf{U}}
\newcommand{\miniVerseParam}{\mathsf{miniVerse}_\mathbf{\forall}}
\newcommand{\miniVerseTSL}{\mathsf{miniVerse}_\textbf{TSL}}

% General abstract syntax
\newcommand{\aboppz}[2]{\texttt{#1}\texttt{[}#2\texttt{]}}
\newcommand{\abop}[2]{\texttt{#1}\texttt{(}#2\texttt{)}}
\newcommand{\abopi}[3]{\texttt{#1}[#2]\texttt{(}#3\texttt{)}}
\newcommand{\abopii}[4]{\texttt{#1}[#2][#3]\texttt{(}#4\texttt{)}}
\newcommand{\abopic}[4]{\texttt{#1}[#2]\texttt{\{}#3\texttt{\}(}#4\texttt{)}}
\newcommand{\abopp}[3]{\texttt{#1}\texttt{[}#2\texttt{](}#3\texttt{)}}
\newcommand{\abopc}[3]{\texttt{#1}\texttt{\{}#2\texttt{\}(}#3\texttt{)}}
\newcommand{\abopbc}[4]{\texttt{#1}\texttt{[}#2\texttt{]\{}#3\texttt{\}(}#4\texttt{)}}
\newcommand{\abopibc}[5]{\texttt{#1}[#2]\texttt{[}#3\texttt{]\{}#4\texttt{\}(}#5\texttt{)}}
\newcommand{\abopcc}[4]{\texttt{#1}\texttt{\{}#2\texttt{\}\{}#3\texttt{\}(}#4\texttt{)}}

% Types / candidate expansion types
\newcommand{\parr}[2]{#1 \rightharpoonup #2}
\newcommand{\aparr}[2]{\abop{parr}{#1; #2}}
\newcommand{\aceparr}[2]{\abop{ceparr}{#1; #2}}

\newcommand{\forallt}[2]{\forall #1.#2}
\newcommand{\aall}[2]{\abop{all}{#1.#2}}
\newcommand{\aceall}[2]{\abop{ceall}{#1.#2}}

\newcommand{\rect}[2]{\mu #1.#2}
\newcommand{\arec}[2]{\abop{rec}{#1.#2}}
\newcommand{\acerec}[2]{\abop{cerec}{#1.#2}}

\newcommand{\prodt}[1]{\langle #1 \rangle}
\newcommand{\aprod}[2]{\abopi{prod}{#1}{#2}}
\newcommand{\aceprod}[2]{\abopi{ceprod}{#1}{#2}}

\newcommand{\sumt}[1]{[#1]}
\newcommand{\asum}[2]{\abopi{sum}{#1}{#2}}
\newcommand{\acesum}[2]{\abopi{cesum}{#1}{#2}}

% Labels and maps
\newcommand{\labelset}{L}
\newcommand{\mapschema}[3]{\{#2 \hookrightarrow #1_{#2}\}_{#2 \in #3}}
\newcommand{\mapschemab}[4]{\{#3 \hookrightarrow #1_{#3}.#2_{#3}\}_{#3 \in #4}}
\newcommand{\mapschemax}[4]{\{#3 \hookrightarrow #1(#2_{#3})\}_{#3 \in #4}}
\newcommand{\mapschemabx}[5]{\{#4 \hookrightarrow #2_{#4}.#1(#3_{#4})\}_{#4 \in #5}}
\newcommand{\finmap}[1]{#1}
\newcommand{\mapitem}[2]{#1 \hookrightarrow #2}
\newcommand{\lbltxt}[1]{\mathtt{#1}}

% sequences
\newcommand{\seqschema}[4]{\{#1_{#2}\}_{#3 \leq #2 \leq #4}}
\newcommand{\seqschemaX}[1]{\seqschema{#1}{i}{1}{n}}
\newcommand{\seqschemaXx}[2]{\{#1(#2_i)\}_{1 \leq i \leq n}}

% Expanded/Unexpanded/Candidate expressions
\newcommand{\lam}[3]{\lambda #1{:}#2.#3}
\newcommand{\aelam}[3]{\abopc{elam}{#1}{#2.#3}}
\newcommand{\aulam}[3]{\abopc{ulam}{#1}{#2.#3}}
\newcommand{\acelam}[3]{\abopc{celam}{#1}{#2.#3}}

\newcommand{\ap}[2]{#1(#2)}
\newcommand{\aeap}[2]{\abop{eap}{#1; #2}}
\newcommand{\auap}[2]{\abop{uap}{#1; #2}}
\newcommand{\aceap}[2]{\abop{ceap}{#1; #2}}

\newcommand{\Lam}[2]{\Lambda #1.#2}
\newcommand{\aetlam}[2]{\abop{etlam}{#1.#2}}
\newcommand{\autlam}[2]{\abop{utlam}{#1.#2}}
\newcommand{\acetlam}[2]{\abop{cetlam}{#1.#2}}

\newcommand{\App}[2]{#1\texttt{[}#2\texttt{]}}
\newcommand{\aetap}[2]{\abopc{etap}{#2}{#1}}
\newcommand{\autap}[2]{\abopc{utap}{#2}{#1}}
\newcommand{\acetap}[2]{\abopc{cetap}{#2}{#1}}

\newcommand{\fold}[1]{\texttt{fold}(#1)}
\newcommand{\aefold}[3]{\abopc{efold}{#1.#2}{#3}}
\newcommand{\aufold}[3]{\abopc{ufold}{#1.#2}{#3}}
\newcommand{\acefold}[3]{\abopc{cefold}{#1.#2}{#3}}

\newcommand{\unfold}[1]{\texttt{unfold}(#1)}
\newcommand{\aeunfold}[1]{\abop{eunfold}{#1}}
\newcommand{\auunfold}[1]{\abop{uunfold}{#1}}
\newcommand{\aceunfold}[1]{\abop{ceunfold}{#1}}

\newcommand{\tpl}[1]{\langle #1\rangle}
\newcommand{\aetpl}[2]{\abopi{etpl}{#1}{#2}}
\newcommand{\autpl}[2]{\abopi{utpl}{#1}{#2}}
\newcommand{\acetpl}[2]{\abopi{cetpl}{#1}{#2}}

\newcommand{\prj}[2]{#1 \cdot #2}
\newcommand{\aepr}[2]{\abopp{epr}{#1}{#2}}
\newcommand{\aupr}[2]{\abopp{upr}{#1}{#2}}
\newcommand{\acepr}[2]{\abopp{cepr}{#1}{#2}}

\newcommand{\inj}[2]{#1 \cdot #2}
\newcommand{\aein}[4]{\abopibc{ein}{#1}{#2}{#3}{#4}}
\newcommand{\auin}[4]{\abopibc{uin}{#1}{#2}{#3}{#4}}
\newcommand{\acein}[4]{\abopibc{cein}{#1}{#2}{#3}{#4}}

\newcommand{\caseof}[2]{\texttt{case}~#1~#2}
\newcommand{\aecase}[4]{\abopic{ecase}{#1}{#2}{#3; #4}}
\newcommand{\aucase}[4]{\abopic{ucase}{#1}{#2}{#3; #4}}
\newcommand{\acecase}[4]{\abopic{cecase}{#1}{#2}{#3; #4}}

% Expanded expressions
\newcommand{\etxt}[1]{e_\text{#1}}

\newcommand{\Uofv}{\mathcal{U}}
\newcommand{\Uof}[1]{\Uofv(#1)}
\newcommand{\VTypofv}{\mathcal{V}_\mathsf{Typ}}
\newcommand{\VTypof}[1]{\VTypofv(#1)}
\newcommand{\VExpofv}{\mathcal{V}_\mathsf{EExp}}
\newcommand{\VExpof}[1]{\VExpofv(#1)}

% Statics of miniVerseU expanded expressions
\newcommand{\istypeU}[2]{#1 \vdash #2~\mathsf{type}}
\newcommand{\isctxU}[2]{#1 \vdash #2~\mathsf{ctx}}
\newcommand{\hastypeU}[4]{#1~#2 \vdash #3 : #4}
\newcommand{\hastypeUC}[2]{\vdash #1 : #2}
\newcommand{\hastypeUCO}[3]{#1 \vdash #2 : #3}

\newcommand{\Dhyp}[1]{#1~\mathsf{type}}
\newcommand{\Dcons}[2]{{#1}\cup{#2}}
\newcommand{\Ghyp}[2]{#1 : #2}
\newcommand{\Gcons}[2]{{#1}\cup{#2}}
\newcommand{\Gconsi}[2]{\cup_{#1} #2}

% Dynamics of miniVerseU
\newcommand{\isvalU}[1]{#1~\mathsf{val}}
\newcommand{\stepsU}[2]{#1 \mapsto #2}
\newcommand{\multistepU}[2]{#1 \mapsto^{*} #2}
\newcommand{\evalU}[2]{#1 \Downarrow #2}

% Unexpanded types
\newcommand{\utau}{{\hat\tau}}
\newcommand{\ut}{{\hat{t}}}

% Unexpanded expressions
\newcommand{\ue}{{\hat e}}
\newcommand{\ux}{{\hat x}}
\newcommand{\uesyntax}[4]{\texttt{syntax}~#1~\texttt{at}~#2~\{#3\}~\texttt{in}~#4}
\newcommand{\audefuetsm}[4]{\abopcc{usyntaxue}{#1}{#2}{#3.#4}}
\newcommand{\utsmap}[2]{#1~\texttt{/}#2\texttt{/}}
\newcommand{\autsmap}[2]{\texttt{uapuetsm}[#1]\texttt{[}#2\texttt{]}}
\newcommand{\uet}[1]{\ue_\text{#1}}
\newcommand{\ueparse}{\uet{parse}}

% TSM expressions
\newcommand{\tsmv}{a}
\newcommand{\utsmdef}[2]{\texttt{syntax}~@~#1~\texttt{\{}#2\texttt{\}}}
\newcommand{\istsmU}[2]{#1 \vdash #2~\mathsf{tsm}}

\newcommand{\uGamma}{\hat{\Gamma}}
\newcommand{\uDelta}{\hat{\Delta}}
\newcommand{\uD}{\mathcal{D}}
\newcommand{\uG}{\mathcal{G}}
\newcommand{\uDD}[2]{#1 \vert #2}
\newcommand{\uGG}[2]{#1 \vert #2}
\newcommand{\uGammaOK}[1]{#1 \vdash \mathsf{ok}}
\newcommand{\uDeltaOK}[1]{#1 \vdash \mathsf{ok}}

\newcommand{\tBody}{\mathtt{Body}}
\newcommand{\tParseResultExp}{\mathtt{ParseResultExp}} 
\newcommand{\tCEExp}{\mathtt{CEExp}} % Typed expansion
\newcommand{\expandsU}[6]{#1~#2 \vdash_{#3} #4 \leadsto #5 : #6} % there's a multiline one in the document done manually
\newcommand{\expandsUX}[3]{\expandsU{\Delta}{\Gamma}{\Sigma}{#1}{#2}{#3}}
\newcommand{\expandsUC}[3]{\vdash #1 \leadsto #2 : #3}
\newcommand{\domof}[1]{\text{dom}(#1)}
\newcommand{\xuetsmdef}[2]{\abop{uetsm}{#1;\,#2}}
\newcommand{\xuetsmbnd}[3]{#1 \hookrightarrow \xuetsmdef{#2}{#3}}
\newcommand{\uetsmenv}[2]{#1 \vdash #2~\mathsf{ok}}
\newcommand{\encodeBody}[2]{#1 \downarrow #2}
\newcommand{\decodeBody}[2]{#1 \uparrow #2}
\newcommand{\ebody}{\etxt{body}}
\newcommand{\eparse}{\etxt{parse}}
\newcommand{\ecand}{\etxt{cand}}
\newcommand{\decodeCondE}[2]{#1 \uparrow_\mathsf{CEExp} #2}
\newcommand{\encodeCondE}[2]{#1 \downarrow_\mathsf{CEExp} #2}

% Candidate Expansions
\newcommand{\ce}{\grave{e}}
\newcommand{\ctau}{\grave{\tau}}

\newcommand{\splicedt}[2]{\texttt{spliced}\langle#1, #2\rangle}
\newcommand{\acesplicedt}[2]{\texttt{cesplicedt}[#1; #2]}
\newcommand{\splicede}[2]{\texttt{spliced}\langle#1, #2\rangle}
\newcommand{\acesplicede}[2]{\texttt{cesplicede}[#1; #2]}
\newcommand{\splicedp}[2]{\texttt{spliced}\langle#1, #2\rangle}
\newcommand{\acesplicedp}[2]{\texttt{cesplicedp}[#1; #2]}

\newcommand{\mtau}{\dot{\tau}}
\newcommand{\mtspliced}[1]{\texttt{spliced}(#1)}

% Candidate expansion validation
\newcommand{\cvalidT}[4]{#1\vdash^{#2} #3 \leadsto #4~\mathsf{type}}
\newcommand{\cvalidE}[6]{#1~#2\vdash^{#3} #4 \leadsto #5 : #6}
\newcommand{\cvalidEX}[3]{\cvalidE{\Delta}{\Gamma}{\escenev}{#1}{#2}{#3}}
\newcommand{\escenev}{\mathbbmss{E}}
\newcommand{\tscenev}{\mathbbmss{T}}
\newcommand{\esceneU}[4]{#1;\,#2;\,#3;\,#4}
\newcommand{\esceneUP}[5]{#1;\,#2;\,#3;\,#4;\,#5}
\newcommand{\tsceneU}[2]{#1;\,#2}
\newcommand{\tsceneUP}[2]{\tsceneU{#1}{#2}}
\newcommand{\tsfrom}[1]{\mathsf{ts}(#1)}
\newcommand{\parseTyp}[2]{\mathsf{parseTyp}(#1)=#2}
\newcommand{\parseUExp}[2]{\mathsf{parseUExp}(#1)=#2}
\newcommand{\bsubseq}[3]{\mathsf{subseq}(#1; #2; #3)}

\newcommand{\sizeof}[1]{\Vert #1 \Vert}

% Pattern matching
\newcommand{\matchwith}[2]{\texttt{match}~#1~#2}
\newcommand{\aematchwith}[4]{\abopic{ematch}{#1}{#2}{#3; #4}}
\newcommand{\aumatchwith}[4]{\abopic{umatch}{#1}{#2}{#3; #4}}
\newcommand{\acematchwith}[4]{\abopic{cematch}{#1}{#2}{#3; #4}}

\newcommand{\matchrule}[2]{#1 \Rightarrow #2}
\newcommand{\aematchrule}[4]{\abopic{erule}{#1}{#2}{#3.#4}}
\newcommand{\aumatchrule}[4]{\abopic{urule}{#1}{#2}{#3.#4}}
\newcommand{\acematchrule}[4]{\abopic{cerule}{#1}{#2}{#3.#4}}

\newcommand{\ruleType}[5]{#1~#2 \vdash #3 : #4 \Mapsto #5}
\newcommand{\patType}[3]{#1 \Vdash #2 : #3}
\newcommand{\pctx}{\Omega}

\newcommand{\matchfail}[1]{#1~\mathsf{matchfail}}

\newcommand{\eR}{R}
\newcommand{\uR}{\hat{R}}
\newcommand{\cR}{\grave{R}}

\newcommand{\erv}{r}
\newcommand{\urv}{\hat{r}}
\newcommand{\crv}{\grave{r}}

\newcommand{\epv}{p}
\newcommand{\upv}{\hat{p}}
\newcommand{\cpv}{\grave{p}}

\newcommand{\wildp}{\_}
\newcommand{\aewildp}{\texttt{ewildp}}
\newcommand{\auwildp}{\texttt{uwildp}}
\newcommand{\acewildp}{\texttt{cewildp}}

\newcommand{\foldp}[1]{\abop{fold}{#1}}
\newcommand{\aefoldp}[1]{\abop{efoldp}{#1}}
\newcommand{\aufoldp}[1]{\abop{ufoldp}{#1}}
\newcommand{\acefoldp}[1]{\abop{cefoldp}{#1}}

\newcommand{\tplp}[1]{\langle #1 \rangle}
\newcommand{\aetplp}[2]{\abopi{etplp}{#1}{#2}}
\newcommand{\autplp}[2]{\abopi{utplp}{#1}{#2}}
\newcommand{\acetplp}[2]{\abopi{cetplp}{#1}{#2}}

\newcommand{\injp}[2]{#1 \cdot #2}
\newcommand{\aeinjp}[2]{\abopp{einp}{#1}{#2}}
\newcommand{\auinjp}[2]{\abopp{uinp}{#1}{#2}}
\newcommand{\aceinjp}[2]{\abopp{ceinp}{#1}{#2}}


\newcommand{\usyntaxup}[4]{\texttt{syntax}~#1~\texttt{at}~#2~\texttt{for~patterns}~\{#3\}~\texttt{in}~#4}
\newcommand{\audefuptsm}[4]{\abopcc{usyntaxup}{#1}{#2}{#3.#4}}
\newcommand{\auapuptsm}[2]{\texttt{uapuptsm}[#1]\texttt{[}#2\texttt{]}}

\newcommand{\expandsUP}[7]{#1~#2 \vdash_{#3;\,#4} #5 \leadsto #6 : #7} % there's a multiline one in the document done manually
\newcommand{\expandsUPX}[3]{\expandsUP{\Delta}{\Gamma}{\Sigma}{\Phi}{#1}{#2}{#3}}

\newcommand{\ruleExpands}[8]{#1~#2 \vdash_{#3;\,#4} #5 \leadsto #6 : #7 \Mapsto #8}
\newcommand{\patExpands}[5]{#1 \vdash_{#2} #3 \leadsto #4 : #5}
\newcommand{\xuptsmdef}[2]{\abop{uptsm}{#1;\,#2}}
\newcommand{\xuptsmbnd}[3]{#1 \hookrightarrow \xuptsmdef{#2}{#3}}
\newcommand{\uptsmenv}[2]{#1 \vdash #2~\mathsf{ok}}

\newcommand{\tParseResultPat}{\mathtt{ParseResultPat}} 
\newcommand{\tCEPat}{\mathtt{CEPat}} % Typed expansion

\newcommand{\decodeCEPat}[2]{#1 \uparrow_\mathsf{CEPat} #2}
\newcommand{\encodeCEPat}[2]{#1 \downarrow_\mathsf{CEPat} #2}

\newcommand{\cvalidP}[5]{\vdash^{#1;\,#2} #3 \leadsto #4 : #5}
\newcommand{\cvalidR}[7]{#1~#2 \vdash^{#3} #4 \leadsto #5 : #6 \Mapsto #7}
\newcommand{\pscenev}{\mathbbmss{P}}
\newcommand{\pscene}[2]{#1;\,#2}

\newcommand{\parseUPat}[2]{\mathsf{parseUPat}(#1)=#2}
